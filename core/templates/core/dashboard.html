<!-- core/templates/core/dashboard.html -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Dashboard de Vagas</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet">
</head>
<body class="p-4">

  <h1 class="mb-4">Dashboard de Vagas</h1>

  <!-- CARDS DE MÉTRICAS -->
  <div class="row mb-4">

    <!-- Vagas Abertas -->
    <div class="col-md-3">
      <div class="card text-white bg-primary mb-2">
        <div class="card-body">
          <h5 class="card-title">Vagas Abertas</h5>
          <p class="card-text display-6">{{ abertas }}</p>
        </div>
      </div>
    </div>

    <!-- Vagas Fechadas -->
    <div class="col-md-3">
      <div class="card text-white bg-secondary mb-2">
        <div class="card-body">
          <h5 class="card-title">Vagas Fechadas</h5>
          <p class="card-text display-6">{{ fechadas }}</p>
        </div>
      </div>
    </div>

    <!-- Idade Média -->
    <div class="col-md-3">
      <div class="card text-white bg-success mb-2">
        <div class="card-body">
          <h5 class="card-title">Idade Média</h5>
          <p class="card-text display-6">{{ media_idade }} anos</p>
        </div>
      </div>
    </div>

    <!-- Setor Mais Ativo -->
    <div class="col-md-3">
      <div class="card text-white bg-info mb-2">
        <div class="card-body">
          <h5 class="card-title">Setor Mais Ativo</h5>
          <p class="card-text display-6">{{ setor_mais_vagas }}</p>
        </div>
      </div>
    </div>

  </div>

  <!-- Tabela detalhada -->
  <div class="mb-5">
    {{ tabela_html|safe }}
  </div>

  <!-- Container do gráfico com dados embutidos -->
  <div
    id="chart-container"
    data-labels='{{ chart_labels_json|escapejs }}'
    data-values='{{ chart_values_json|escapejs }}'>
  </div>

  <!-- Chart.js e inicialização -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const container = document.getElementById('chart-container');
    const labels = JSON.parse(container.dataset.labels);
    const values = JSON.parse(container.dataset.values);
    const canvas = document.createElement('canvas');
    container.appendChild(canvas);
    const ctx = canvas.getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: 'Candidatos por Vaga',
          data: values,
          backgroundColor: 'rgba(0, 123, 255, 0.5)',
          borderColor: 'rgba(0, 123, 255, 1)',
          borderWidth: 1
        }]
      },
      options: {
        scales: { y: { beginAtZero: true } }
      }
    });
  </script>

</body>
</html>
